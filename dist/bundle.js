!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.loggle=t():e.loggle=t()}(self,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{LOG_LEVELS:()=>s,createLogger:()=>d});const r=e=>"function"==typeof e,a=(e,t)=>{const r=Object.entries(e).map((([e,r])=>t(e,r)));return Object.fromEntries(r)},n=e=>r(e)?e:()=>e,o=e=>!Array.isArray(e)&&"object"==typeof e&&null!==e,i=e=>{return t=Object.keys(e),r=t=>o(e[t])?{[t]:!0,...i(e[t])}:{[t]:!0},t.reduce(((e,t)=>({...e,...r(t)})),{});var t,r},s={critical:0,error:1,warn:2,info:3,debug:4},l={enabled:!0,level:"info",formatLogSegments:e=>e.join(" "),prefix:{includeLevelName:!0,includeTime:!0,getCurrentTimeString:()=>(new Date).toLocaleTimeString("en-US",{hour12:!1}),format:e=>`[${e.join(" ")}]`,colors:{critical:"red",error:"orange",warn:"yellow",info:"skyblue",debug:"lightgreen"}},sink:{endpoint:null,func:({message:{asSegments:e,asString:t},metadata:r})=>{console.log(...e)},aggregateTabs:!1},metadata:()=>({clientTimestamp:Date.now()}),replaceParentConfig:!1,replaceParentMetadata:!1,filter:({message:{asSegments:e,asString:t},metadata:r})=>!0},c=(()=>{const e=i(l);return t=>o(t)&&Object.keys(t).every((t=>e.hasOwnProperty(t)))})(),f=(e,t)=>{if(t.replaceParentConfig)return t;if(t.replaceParentMetadata&&e.metadata)return f({...e,metadata:null},t);const r=[e.metadata,t.metadata];if(r.every((e=>e))){const a=r.map(n);return f({...e,metadata:null},{...t,metadata:a})}return a(e,((r,a)=>c(e[r])&&c(t[r])?[r,f(e[r],t[r])]:[r,t.hasOwnProperty(r)?t[r]:a]))},m=(e,t,r)=>{if(!t.prefix)return[];const a=[t.prefix.includeLevelName&&e,t.prefix.includeTime&&t.prefix.getCurrentTimeString()].filter((e=>e)),n=(r?"%c":"")+t.prefix.format(a),o=r?`color: ${t.prefix.colors[e]};`:"";return o?[n,o]:[n]},g=(e,t,r,a)=>[...m(t,r,a),...e].filter((e=>e)),d=(e=l)=>{const t=f(l,e);return{...a(s,((e,a)=>{return[e,(n=e,o=a,(...e)=>{const a=c(e[0]),i=a?f(t,e[0]):t,l=a?e.slice(1):e;if(!i.enabled||o>("number"==typeof(m=i.level)?m:s[m]))return;var m;const d={...Array.isArray(i.metadata)?i.metadata.reduce(((e,t)=>Object.assign(e,t())),{}):(u=i.metadata,r(u)?u():u),level:n};var u;const p=g(l,n,i,!!i.prefix.colors),y=i.formatLogSegments(p);if(i.filter({message:{asString:y,asSegments:p},metadata:d})&&(i.sink.func&&i.sink.func({message:{asString:y,asSegments:p},metadata:d}),i.sink.endpoint)){const e=g(l,n,i,!1);(async(e="",t={})=>{(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},keepalive:!0,body:JSON.stringify(t)})).json()})(i.sink.endpoint,{message:{asString:i.formatLogSegments(e),asSegments:e},metadata:d})}})];var n,o})),createSubLogger:e=>d(f(t,e))}};return t})()));